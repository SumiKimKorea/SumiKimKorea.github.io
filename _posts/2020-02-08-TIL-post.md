---
title: "[MFC] 소켓 프로그래밍_2.소켓"
excerpt: "소켓 통신 관련 학습 내용을 정리합니다."
toc: true
toc_label: 페이지 주요 목차
toc_sticky: true
date: 2020-02-07  08:26:28 -0400
categories:
 - MFC
tags:
 - MFC
 - Socket Programming
 - TCP/IP
---
회사에서 유지보수중인 프로그램 중 소켓 관련된 내용이 있고, 궁금한 사항이 있어 스터디용으로 정리하는 포스팅입니다. 
  
  
# MFC Socket Programming
[TCP/IP 프로토콜](/_posts/2020-02-06-TIL-post.md)에 대해 알아보고, 이 프로토콜 스택을 추상화한 **파일**인 소켓 프로그래밍에 대해 알아봅시다. 
  
소켓(Socket)은 TCP Protocol을 추상화한 File의 일종입니다. 추상화한 파일의 일종이라는 것은, 이 프로토콜을 좀 더 쉽게 사용할 수 있도록 한 함수의 라이브러리 정도라고 생각하면 되겠습니다. 따라서 파일을 처리하는데 중요한 입/출력 기법을 아는 것이 중요합니다.

## 1. 동기 vs 비동기 방식 Socket
클라이언트-서버 통신은 동기식과 비동기 방식 중 어떤 방식으로 개발할 것인지를 결정해야 합니다. 그렇다면 이 둘의 차이점을 알아야 선택하여 개발할 수 있겠죠.

- **동기(Syncronous : 동시에 일어나는)**  
    말 그대로 동시에 일어난다는 뜻입니다. A가 B에게 어떤 일을 요청하면, 요청한 사항이 얼마나 걸리던 상관없이 B는 A에게 결과를 리턴해줘야 합니다. 
- **비동기 (Asyncronous : 동시에 일어나지 않는)**  
    말 그대로 동시에 일어나지 않는다는 뜻입니다. A의 요청에 따른 응답을 B가 즉시 전달해주지 않아도, 그 시간동안 A는 또 다른 작업을 처리할 수 있는 방식입니다.   
  
그렇다면 B의 응답이 올때까지 기다리는 동기식과 B의 응답이 오든 안오든 A의 일을 처리하는 비동기 방식 중에, 비동기 방식이 무조건 유리할거라고 생각할 수도 있습니다. 혹은 내가 개발하는 클라이언트-서버 구조가 비동기가 유리할지 동기가 유리할지 구분하기가 어려울 수도 있습니다.  
  
동기/비동기 개발이 애매할때는 A와 B의 데이터가 반드시 일치해야하는지! 를 파악해야 합니다. 둘의 결과가 일치하지 않을 때 치명적인 결과가 발생한다면 동기식으로 개발을 해야겠죠.  
  
동기 방식의 예를 들어봅시다.  
은행 계좌 처리로 예를 들어보자면, A라는 사람이 B에게 돈을 입금합니다. A의 계좌에서 돈이 빠져나가는 일과 B의 계좌에 돈이 입금되는 일이 일치해야 합니다. 한쪽에서만 입금 혹은 출금이 된다면 치명적인 문제겠죠.  
  
비동기 방식의 예를 봅시다.  
B라는 Client에서 프로그램을 실행하고, A라는 Server에 로그를 넘겨줍니다. B는 자기 할 일을 했기때문에 A가 로그를 잘 받았다는 신호를 주든 말든 자기 일을 처리해도 상관없습니다.  
  
**어떤 작업을 함에 있어 A와 B의 목표가 같은 방향인지, 동시에 발생되어야만 하는 작업인지에 따라서 동기와 비동기를 구분할 수 있겠습니다.**  

하지만 동기 방식이라고 해서 무조건 응답이 오기만을 기다리느냐? 또 그건 아닌 것 같습니다. A는 B에 요청을 하고나서 또 다른 소켓을 열어 멀티스레드로 다른 업무를 처리할 수도 있습니다. 요청에 대한 응답을 기다리는 관심도에 따라서 동기와 비동기를 나눴다면, 요청 이후에 주체자의 추후 행동 방식에 따라 블로킹과 논블로킹을 구분할 수 있습니다.  
  
몹시 헷갈리는군요... 정리하다보니 더 헷갈리는군요...  
추후에 추가적으로 수정이 필요할 것 같습니다...  
  
* 참고 사이트  
    * [1 . 동기와 비동기의 개념과 차이](https://private.tistory.com/24)  
    * [2. 소켓 동기 & 비동기](https://jangpd007.tistory.com/70)  
    * [3. 동기와 비동기 방식에 대한 간단한 개요..](https://makefortune2.tistory.com/188)  
    * [4. 블럭,논블럭,동기,비동기 이야기](https://okky.kr/article/442803)



## 2. 소켓 프로그램 기초
힘들게 동기, 비동기 방식을 정리해보았습니다. 소켓 통신에서 중요한만큼 잘 알고 넘어가는게 중요하겠지만, 우선 정리해보면서 추가적으로 알아가야겠군요.  
  
  
![](/assets/images/MFC/Socket.jpg){: .align-center}
  
TCP/IP에서 소켓은 전송-응용프로그램계층 사이에 존재합니다. 소켓을 사용해 전송 계층의 TCP나 UDP를 이용하여 상대방과 데이터를 주고받을 수 있습니다. 

![](/assets/images/MFC/Client-Server.jpg){: .align-center}
  
소켓 통신은 Server와 Client 간의 데이터 송수신을 진행합니다.  
① Client나 Server 모두 소켓을 우선 생성하고, ② Server가 Listen 상태로 존재할때에 ③ Client가 Server에 접속 요청을 할 수 있습니다. ④ Server는 Accept() 함수를 통해 접속 신청을 확인하며, ⑤ Client는 회선을 확보하게 됩니다.  

 

